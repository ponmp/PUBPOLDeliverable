# loading relevant libraries
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
#library(rigr)
library(knitr)
#library(epiR)
library(cluster)
library(ggplot2)
# Importing the Dataset we prepared in Python from Github
MasterTableRAW <- readRDS(url("https://github.com/ponmp/PUBPOLDeliverableDraft/raw/main/MasterTable.RDS","rb"))
# Making an average of the Suicide rates in the years represented by the other data as a new column
# We pick columns 12 to 22 and take the mean for each country and assign the mean to a new column called SuicideAverage
MasterTableRAW$SuicideAverage <- rowMeans(MasterTableRAW[ , c(11:21)])
MasterTableRAW
# dropping columns for a better table
MasterTable <- MasterTableRAW[ -c(2:21) ]
MasterTable
# show range
MasterTable %>% pull(SuicideAverage) %>% range
# show IQR
MasterTable %>% pull(SuicideAverage) %>% quantile(probs = c(0.25, 0.75))
# show sd
MasterTable %>% pull(SuicideAverage) %>% sd
# show variance
MasterTable %>% pull(SuicideAverage) %>% var
# Make a histogram
MasterTable %>% pull(SuicideAverage) %>% hist(xlab = "Suicide Rate", main = "Distribution of Suicide Rates")
# looking at Alcohol as second variable
MasterTable %>% pull(Alcohol) %>% hist(xlab = "Alcohol consumption", main = "Dist of Alcohol use")
# looking at tobacco use
MasterTable %>% pull(Tobacco) %>% hist(xlab = "Tobacco use", main = "Dist of Tobacco use")
# looking at cocaine use
MasterTable %>% pull(Cocaine) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
lmSRaA <- lm(SuicideAverage~Alcohol, data =  MasterTable)
summary(lmSRaA)
plot(lmSRaA)
# remove country names from master table and add them as the index
WorkingTable <- MasterTable[, -c(1)]
row.names(WorkingTable) <- MasterTable$Country
set.seed(882) # set the noise
DistanceMatrix=daisy(x=WorkingTable) # set matrix to euclidean since everything is numeric
ProjectedData = cmdscale(DistanceMatrix, k=21)
MasterTable$dim1 = ProjectedData[,1]
MasterTable$dim2 = ProjectedData[,2]
MasterTable$dim3 = ProjectedData[,3]
MasterTable$dim4 = ProjectedData[,4]
MasterTable$dim5 = ProjectedData[,5]
MasterTable$dim6 = ProjectedData[,6]
MasterTable$dim7 = ProjectedData[,7]
MasterTable$dim8 = ProjectedData[,8]
MasterTable$dim9 = ProjectedData[,9]
MasterTable$dim10 = ProjectedData[,10]
MasterTable$dim11 = ProjectedData[,11]
MasterTable$dim12 = ProjectedData[,12]
MasterTable$dim13 = ProjectedData[,13]
MasterTable$dim14 = ProjectedData[,14]
MasterTable$dim15 = ProjectedData[,15]
MasterTable$dim16 = ProjectedData[,16]
MasterTable$dim17 = ProjectedData[,17]
MasterTable$dim18 = ProjectedData[,18]
MasterTable$dim19 = ProjectedData[,19]
MasterTable$dim20 = ProjectedData[,20]
MasterTable$dim21 = ProjectedData[,21]
MasterTable[,c('dim1','dim2')][1:60,]
base <- ggplot(data=MasterTable, aes(x=dim1, y=dim9, label=Country))
base + geom_text(size=2)
hc = hclust(DistanceMatrix)
# very simple dendrogram
plot(hc,hang = -1,cex=0.5)
View(WorkingTable)
View(WorkingTable)
# Satisfaction
MasterTable %>% pull(Satisfaction) %>% hist(xlab = "Life Satisfaction Index", main = "Dist of LSI")
# Social Progress
MasterTable %>% pull(`Social Progress Score`) %>% hist(xlab = "Social Progress Score", main = "Dist of SPS")
# Basic Needs
MasterTable %>% pull(`Basic Human Needs`) %>% hist(xlab = "Basic Human Needs", main = "Dist of BHN")
# Wellbeing
MasterTable %>% pull(Cocaine) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# Wellbeing
MasterTable %>% pull(`Foundations of Wellbeing`) %>% hist(xlab = "Foundations of Wellbeing", main = "Dist of FWB")
# opportunity
MasterTable %>% pull(Opportunity) %>% hist(xlab = "Opportunity", main = "Dist of Opportunity")
# nutrition and medical care
MasterTable %>% pull(`Nutrition and Basic Medical Care`) %>% hist(xlab = "Nutrition and Medical", main = "Dist of Nutrition and Medical Care")
# looking at cocaine use
MasterTable %>% pull(`Water and Sanitation`) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(Shelter) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(`Personal Safety`) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(`Personal Safety`) %>% hist(xlab = "Cocaine use", main = "Dist of Personal Safety")
# looking at cocaine use
MasterTable %>% pull(Shelter) %>% hist(xlab = "Cocaine use", main = "Dist of Shelter")
# looking at cocaine use
MasterTable %>% pull(`Water and Sanitation`) %>% hist(xlab = "Cocaine use", main = "Dist Water and Sanitation")
# looking at cocaine use
MasterTable %>% pull(`Personal Rights`) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(`Personal Freedom and Choice`) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(`Personal Freedom and Choice`) %>% hist(xlab = "Cocaine use", main = "Dist of per freedom")
# looking at cocaine use
MasterTable %>% pull(Inclusiveness) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(Inclusiveness) %>% hist(xlab = "Cocaine use", main = "Dist of Inclusiveness")
# looking at cocaine use
MasterTable %>% pull(`Access to Advanced Education`) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(`Access to Advanced Education`) %>% hist(xlab = "Cocaine use", main = "Dist of Adv Edu")
# looking at cocaine use
MasterTable %>% pull(`Access to Basic Knowledge`) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# looking at cocaine use
MasterTable %>% pull(`Access to Basic Knowledge`) %>% hist(xlab = "Cocaine use", main = "Dist of Basic Knowledge")
# looking at cocaine use
MasterTable %>% pull(`Access to Basic Knowledge`) %>% hist(xlab = "Cocaine use", main = "Dist of Basic Knowledge")
summary(MasterTable$Alcohol)
summary(MasterTable$Alcohol.lm)
summary(MasterTable$Alcohol)
Alcohol <- MasterTable %>% pull(Alcohol)
Suicide <- MasterTable %>% pull(SuicideAverage)
lm(SuicideAverage~Alcohol, data =  MasterTable) %>% Summary()
Summary(lm(SuicideAverage~Alcohol, data =  MasterTable))
lmSRaA <- lm(SuicideAverage~Alcohol, data =  MasterTable)
summary(lmSRaA)
lmSRaT <- lm(SuicideAverage~Tobacco, data =  MasterTable)
summary(lmSRaT)
lmSRaS <- lm(SuicideAverage~Satisfaction, data =  MasterTable)
summary(lmSRaS)
lmSRaSP <- lm(SuicideAverage~"Social Progress Score", data =  MasterTable)
lmSRaSP <- lm(SuicideAverage~'Social Progress Score', data =  MasterTable)
# Social Progress
MasterTable %>% pull(`Social Progress Score`) %>% hist(xlab = "Social Progress Score", main = "Dist of Social Progress Score")
SPS <- MasterTable$`Social Progress Score`
lmSRaSP <- lm(SuicideAverage~'Social Progress Score', data =  MasterTable)
SPS <- MasterTable$`Social Progress Score`
lmSRaSP <- lm(SuicideAverage~SPS, data =  MasterTable)
summary(lmSRaSP)
FWB <- MasterTable$`Foundations of Wellbeing`
lmSRaWB <- lm(SuicideAverage~FWB, data =  MasterTable)
summary(lmSRaSP)
FWB <- MasterTable$`Foundations of Wellbeing`
lmSRaWB <- lm(SuicideAverage~FWB, data =  MasterTable)
summary(lmSRaWB)
PS <- MasterTable$`Personal Safety`
lmSRaPS <- lm(SuicideAverage~PS, data =  MasterTable)
summary(lmSRaPS)
# looking at cocaine use
MasterTable %>% pull(`Personal Safety`) %>% hist(xlab = "Degree of Personal Safety", main = "Distribution of Personal Safety")
PS <- MasterTable$`Personal Safety`
lmSRaPS <- lm(SuicideAverage~PS, data =  MasterTable)
summary(lmSRaPS)
PF <- MasterTable$`Personal Freedom and Choice`
lmSRaPF <- lm(SuicideAverage~PF, data =  MasterTable)
summary(lmSRaPF)
#PF <- MasterTable$`Personal Freedom and Choice`
lmSRaI <- lm(SuicideAverage~Inclusiveness, data =  MasterTable)
summary(lmSRaI)
AE <- MasterTable$`Access to Advanced Education`
lmSRaAE <- lm(SuicideAverage~AE, data =  MasterTable)
summary(lmSRaAE)
