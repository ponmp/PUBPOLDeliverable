---
title: "Deliverable Draft 2"
author: "Matthew Pon"
date: "2023-02-14"
output: html_document
---
|                        |                  |
| ---------------------- | ---------------- |
| Project URL            | https://github.com/ponmp/PUBPOLDeliverableDraft |
| Organization URL       | https://github.com/HedgehogsAnonymous           |
|                        |                  |

```{r setup, echo=FALSE, include=FALSE}
# loading relevant libraries
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
#library(rigr)
library(knitr)
#library(epiR)
library(cluster)
library(ggplot2)
```

## Second part of Deliverable Draft

```{r, echo=FALSE, include=TRUE}
# Importing the Dataset we prepared in Python from Github
MasterTableRAW <- readRDS(url("https://github.com/ponmp/PUBPOLDeliverableDraft/raw/main/MasterTable.RDS","rb"))
```

### Working with the data

We need to average the suicide rates to analyze the data.
First we create a new column that averages suicide from relevant years. The years should match the range the other data was recorded from.
```{r, echo=TRUE, include=FALSE}
# Making an average of the Suicide rates in the years represented by the other data as a new column
# We pick columns 12 to 22 and take the mean for each country and assign the mean to a new column called SuicideAverage
MasterTableRAW$SuicideAverage <- rowMeans(MasterTableRAW[ , c(11:21)])
MasterTableRAW
```
Now we get can drop the individual years from the table and look for trends in the data.
```{r, echo=TRUE, include=FALSE}
# dropping columns for a better table
MasterTable <- MasterTableRAW[ -c(2:21) ]
MasterTable
```
The range
```{r, echo=FALSE, include=TRUE}
# show range
MasterTable %>% pull(SuicideAverage) %>% range
```
The IQR
```{r, echo=FALSE, include=TRUE}
# show IQR
MasterTable %>% pull(SuicideAverage) %>% quantile(probs = c(0.25, 0.75))
```
Standard Deviation
```{r, echo=FALSE, include=TRUE}
# show sd
MasterTable %>% pull(SuicideAverage) %>% sd 
```
Variance
```{r, echo=FALSE, include=TRUE}
# show variance
MasterTable %>% pull(SuicideAverage) %>% var
```

This is a histogram of the average suicide rates. Notice it's right skewed.
```{r, echo=FALSE, include=TRUE}
# Make a histogram
MasterTable %>% pull(SuicideAverage) %>% hist(xlab = "Suicide Rate", main = "Distribution of Suicide Rates")
```

Selecting another variable

```{r, echo=FALSE, include=TRUE}
# looking at Alcohol as second variable
MasterTable %>% pull(Alcohol) %>% hist(xlab = "Alcohol consumption", main = "Dist of Alcohol use")
```
```{r, echo=FALSE, include=TRUE}
lmSRaA <- lm(SuicideAverage~Alcohol, data =  MasterTable)
summary(lmSRaA)
```


```{r, echo=FALSE, include=TRUE}
# looking at tobacco use
MasterTable %>% pull(Tobacco) %>% hist(xlab = "Tobacco use", main = "Dist of Tobacco use")
```
```{r, echo=FALSE, include=TRUE}
lmSRaT <- lm(SuicideAverage~Tobacco, data =  MasterTable)
summary(lmSRaT)
```

```{r, echo=FALSE, include=TRUE}
# looking at cocaine use
#MasterTable %>% pull(Cocaine) %>% hist(xlab = "Cocaine use", main = "Dist of Cocaine use")
# not normal distribution
```
```{r, echo=FALSE, include=TRUE}
# Satisfaction
MasterTable %>% pull(Satisfaction) %>% hist(xlab = "Life Satisfaction Index", main = "Dist of LSI")
```
```{r, echo=FALSE, include=TRUE}
lmSRaS <- lm(SuicideAverage~Satisfaction, data =  MasterTable)
summary(lmSRaS)
```

```{r, echo=FALSE, include=TRUE}
# Social Progress
MasterTable %>% pull(`Social Progress Score`) %>% hist(xlab = "Social Progress Score", main = "Dist of Social Progress Score")
```
```{r, echo=FALSE, include=TRUE}
SPS <- MasterTable$`Social Progress Score`
lmSRaSP <- lm(SuicideAverage~SPS, data =  MasterTable)
summary(lmSRaSP)
```

```{r, echo=FALSE, include=TRUE}
#MasterTable %>% pull(`Basic Human Needs`) %>% hist(xlab = "Basic Human Needs", main = "Dist of BHN")
# Not Normally Distributed
```

```{r, echo=FALSE, include=TRUE}
# Wellbeing
MasterTable %>% pull(`Foundations of Wellbeing`) %>% hist(xlab = "Foundations of Wellbeing", main = "Dist of FWB")
```
```{r, echo=FALSE, include=TRUE}
FWB <- MasterTable$`Foundations of Wellbeing`
lmSRaWB <- lm(SuicideAverage~FWB, data =  MasterTable)
summary(lmSRaWB)
```

```{r, echo=FALSE, include=TRUE}
#MasterTable %>% pull(Opportunity) %>% hist(xlab = "Opportunity", main = "Dist of Opportunity")
# not normally distributed
```

```{r, echo=FALSE, include=TRUE}
#MasterTable %>% pull(`Nutrition and Basic Medical Care`) %>% hist(xlab = "Nutrition and Medical", main = "Dist of Nutrition and Medical Care")
# not normally distributed
```

```{r, echo=FALSE, include=TRUE}
#MasterTable %>% pull(`Water and Sanitation`) %>% hist(xlab = "Cocaine use", main = "Dist Water and Sanitation")
# not normally distributed
```

```{r, echo=FALSE, include=TRUE}
#MasterTable %>% pull(Shelter) %>% hist(xlab = "Cocaine use", main = "Dist of Shelter")
# not normally distributed
```

```{r, echo=FALSE, include=TRUE}
# personal safety
MasterTable %>% pull(`Personal Safety`) %>% hist(xlab = "Degree of Personal Safety", main = "Distribution of Personal Safety")
```
```{r, echo=FALSE, include=TRUE}
PS <- MasterTable$`Personal Safety`
lmSRaPS <- lm(SuicideAverage~PS, data =  MasterTable)
summary(lmSRaPS)
```

```{r, echo=FALSE, include=TRUE}
#MasterTable %>% pull(`Personal Rights`) %>% hist(xlab = "Cocaine use", main = "Dist of Per Rights")
# not normally distributed
```

```{r, echo=FALSE, include=TRUE}
# personal freedom
MasterTable %>% pull(`Personal Freedom and Choice`) %>% hist(xlab = "Personal Freedom", main = "Dist of Personal Freedom")
```
```{r, echo=FALSE, include=TRUE}
PF <- MasterTable$`Personal Freedom and Choice`
lmSRaPF <- lm(SuicideAverage~PF, data =  MasterTable)
summary(lmSRaPF)
```

```{r, echo=FALSE, include=TRUE}
# inclusiveness
MasterTable %>% pull(Inclusiveness) %>% hist(xlab = "Cocaine use", main = "Dist of Inclusiveness")
```
```{r, echo=FALSE, include=TRUE}
lmSRaI <- lm(SuicideAverage~Inclusiveness, data =  MasterTable)
summary(lmSRaI)
```

```{r, echo=FALSE, include=TRUE}
# looking at adv edu
MasterTable %>% pull(`Access to Advanced Education`) %>% hist(xlab = "Access to Advanced Education", main = "Dist of Adv. Edu.")
```
```{r, echo=FALSE, include=TRUE}
AE <- MasterTable$`Access to Advanced Education`
lmSRaAE <- lm(SuicideAverage~AE, data =  MasterTable)
summary(lmSRaAE)
```
```{r, echo=FALSE, include=TRUE}
plot(lmSRaA)
```


## Clustering the data

```{r, echo=FALSE, include=TRUE}
# remove country names from master table and add them as the index
WorkingTable <- MasterTable[, -c(1)]
row.names(WorkingTable) <- MasterTable$Country
set.seed(882) # set the noise
DistanceMatrix=daisy(x=WorkingTable) # set matrix to euclidean since everything is numeric
ProjectedData = cmdscale(DistanceMatrix, k=21)
# check 
MasterTable$dim1 = ProjectedData[,1]
MasterTable$dim2 = ProjectedData[,2]
MasterTable$dim3 = ProjectedData[,3]
MasterTable$dim4 = ProjectedData[,4]
MasterTable$dim5 = ProjectedData[,5]
MasterTable$dim6 = ProjectedData[,6]
MasterTable$dim7 = ProjectedData[,7]
MasterTable$dim8 = ProjectedData[,8]
MasterTable$dim9 = ProjectedData[,9]
MasterTable$dim10 = ProjectedData[,10]
MasterTable$dim11 = ProjectedData[,11]
MasterTable$dim12 = ProjectedData[,12]
MasterTable$dim13 = ProjectedData[,13]
MasterTable$dim14 = ProjectedData[,14]
MasterTable$dim15 = ProjectedData[,15]
MasterTable$dim16 = ProjectedData[,16]
MasterTable$dim17 = ProjectedData[,17]
MasterTable$dim18 = ProjectedData[,18]
MasterTable$dim19 = ProjectedData[,19]
MasterTable$dim20 = ProjectedData[,20]
MasterTable$dim21 = ProjectedData[,21]
MasterTable[,c('dim1','dim2')][1:60,]
```
```{r, echo=FALSE, include=TRUE}
base <- ggplot(data=MasterTable, aes(x=dim1, y=dim9, label=Country)) 
base + geom_text(size=2)
```

```{r, echo=FALSE, include=TRUE}
hc = hclust(DistanceMatrix)
# very simple dendrogram
plot(hc,hang = -1,cex=0.5)
```
 
 
 
## Linear Regression
 
Checking for variables with normality


# Appendix

**R code used:**
```{r, ref.label=knitr::all_labels(),echo=TRUE,eval=FALSE}
```